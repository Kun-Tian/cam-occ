#!/bin/sh

#This script uses the rs274ngc interpreter (from code.google.com)
#to parse g-code into canonical commands.  It filters out certain
#commands, then pipes the rest to a file.  

current=`pwd`
infile=$1
outfile=$current/output
rs274dir=~/projects/nist/rs274ngc   #path to rs274 executable
cd $rs274dir
echo 1 | \
rs274 $infile 2>/dev/null | \
sed -e 's/^.....\ N..... //;' \
    -e '/COMMENT/d;' \
    -e '/SPINDLE/d;' \
    -e '/MIST/d;' \
    -e '/ENABLE/d;' \
    -e '/FLOOD/d;' \
    -e '/DWELL/d;' \
    -e '/FEEDRATE/d;' \
    >$outfile
cd $current
